
O = lo

SOCKOBJS = socket.$(O) serial.$(O) inetserial.$(O) slp.$(O) padp.$(O) \
       dlp.$(O) cmp.$(O) syspkt.$(O)

FILEOBJS = pi-file.$(O)

APPOBJS = datebook.$(O) memo.$(O) address.$(O) todo.$(O) expense.$(O) mail.$(O) sync.$(O)

UTILOBJS = utils.$(O)

SERIAL = unixserial.$(O)

OBJS = $(SOCKOBJS) $(FILEOBJS) $(APPOBJS) $(UTILOBJS) $(SERIAL)

prefix = @prefix@
exec_prefix = ${prefix}
libdir = @libdir@
srcdir = @srcdir@
VPATH = @srcdir@

top_builddir = ..

CC = @CC@
CFLAGS = -I../include -I$(srcdir)/../include @CFLAGS@ @CWFLAG@
# -DPADP_TRACE
# -DDEBUG
# -DNO_DLP_TRACE
# -DNO_SERIAL_TRACE
AR = ar
ARFLAGS = @ARFLAGS@
RANLIB = @RANLIB@
RM = rm -f
LIBTOOL = @LIBTOOL@

.SUFFIXES: .c .lo .o

.c.o:
	$(CC) $(CFLAGS) -c $<

.c.lo:
	$(LIBTOOL) --mode=compile $(CC) $(CFLAGS) -c $<

all: libpisock.la

libpisock.a: $(OBJS)
	$(RM) libpisock.a
	$(AR) $(ARFLAGS) libpisock.a $(OBJS)
	$(RANLIB) libpisock.a

libpisock.la: $(OBJS)
	$(LIBTOOL) --mode=link $(CC) $(CFLAGS) \
		-export-dynamic -rpath $(libdir) -version-info 0:0:0 \
		-o libpisock.la $(OBJS)

clean:
	$(RM) *.o *.lo *.a *.la core a.out *.orig
	$(RM) -r .libs

depend:
	perl -i~ -ne 'print if 1../^#Depend/' Makefile.in ; gcc -MM -I../include *.c | perl -pne 's/\.o/.lo/g' >> Makefile.in

#Dependencies
address.lo: address.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-dlp.h ../include/pi-address.h
cmp.lo: cmp.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-padp.h ../include/pi-cmp.h ../include/pi-serial.h
datebook.lo: datebook.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-dlp.h ../include/pi-datebook.h
dlp.lo: dlp.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-dlp.h ../include/pi-syspkt.h
expense.lo: expense.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-dlp.h ../include/pi-expense.h
inetserial.lo: inetserial.c ../include/pi-source.h \
 ../include/pi-config.h ../include/pi-socket.h ../include/pi-args.h \
 ../include/pi-macros.h ../include/pi-serial.h \
 ../include/pi-inetserial.h ../include/pi-slp.h ../include/pi-syspkt.h \
 ../include/pi-padp.h
mail.lo: mail.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-dlp.h ../include/pi-mail.h
memo.lo: memo.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-dlp.h ../include/pi-memo.h
os2serial.lo: os2serial.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-serial.h ../include/pi-slp.h ../include/pi-syspkt.h \
 ../include/pi-padp.h
padp.lo: padp.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-padp.h ../include/pi-slp.h ../include/pi-serial.h
pi-file.lo: pi-file.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-file.h ../include/pi-dlp.h
serial.lo: serial.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-serial.h ../include/pi-inetserial.h \
 ../include/pi-padp.h ../include/pi-cmp.h ../include/pi-dlp.h \
 ../include/pi-syspkt.h
slp.lo: slp.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-slp.h
socket.lo: socket.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-serial.h ../include/pi-inetserial.h \
 ../include/pi-inet.h ../include/pi-padp.h ../include/pi-cmp.h \
 ../include/pi-dlp.h ../include/pi-syspkt.h
sync.lo: sync.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-dlp.h ../include/pi-sync.h
syspkt.lo: syspkt.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-syspkt.h ../include/pi-slp.h ../include/pi-serial.h
todo.lo: todo.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h \
 ../include/pi-dlp.h ../include/pi-todo.h
unixserial.lo: unixserial.c ../include/pi-source.h \
 ../include/pi-config.h ../include/pi-socket.h ../include/pi-args.h \
 ../include/pi-macros.h ../include/pi-serial.h ../include/pi-slp.h \
 ../include/pi-syspkt.h ../include/pi-padp.h
utils.lo: utils.c ../include/pi-source.h ../include/pi-config.h \
 ../include/pi-socket.h ../include/pi-args.h ../include/pi-macros.h
